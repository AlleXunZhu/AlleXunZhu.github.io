# 游戏测试

## 1. 游戏开发团队，主要工作及工作流程

### 1-1 游戏开发团队及流程简介

- 游戏开发团队

  > 制作人；
  >
  > 策划、程序、美术、测试

  - 制作人 — 项目整体负责人

    - 负责游戏研发环节
    - 负责游戏运营环节
    - 负责项目人员管理
    - 负责项目事务管理

  - 策划

    - 剧情：负责规划剧情，故事，背景
    - 系统：设计游戏中系统规则
    - 数值：规划游戏中各资源产出，消耗
    - 关卡：设计游戏中各关卡

  - 程序

    > 代码实现人员，负责把策划的设计和美术资源通过编码实现可玩的程序；

    - 前端程序：实现游戏客户端的展现与逻辑；
    - 后端程序：实现服务器端的逻辑，数据验证等；

  - 美术 — 制作游戏中各类美术资源

    - 场景
    - 原画
    - UI
    - 动画

  - 测试 — 项目质量保证人员

    - 功能测试
    - 性能测试
    - 压力测试
    - 兼容测试
    - 自动化测试
    - 安全测试

- 游戏开发流程

  - 制作人 — 制定项目目标，规划
  - 策划 — 将项目目标拆解成细致的需求，并将需求细化成文案
  - 测试、程序、美术 — 各自工作
  - 测试 — 对项目各方面进行质量控制，将缺陷反馈出来

### 1-2 游戏测试主要工作内容

- 功能测试
  - 最常见，主要黑盒测试；
  - 主要验证功能是否符合需求设计；
  - 主要考虑功能正确性，不考虑游戏底层结构及代码错误；
  - 通常从界面开始测试，尽量模拟用户可能出现操作；
- 客户端性能测试
  - 客户端CPU使用率
  - 客户端内存占用率
  - 客户端网络流量使用情况
  - 客户端耗电量
  - 客户端帧率（FPS）
  - ios常用工具 Xcode自带的**instrument**
  - 安卓端常用**emmage**和**GT**
- 服务端压力测试
  - 服务器CPU使用率
  - 服务器内存占用率
  - 系统吞吐量（TPS）
  - 事务响应时间
  - 事务成功率
- 兼容测试
  - 机型适配测试
  - 操作系统兼容测试
  - 屏幕分辨率兼容测试
  - 游戏版本兼容测试
- 安全测试
  - 内存修改测试
  - 客户端加密测试
  - 客户端反编译测试
  - 网络安全测试
- 接口测试
  - 服务器各个接口数据测试，主要通过工具实现
  - 接口安全测试，反复发送请求，查看接口处流情况
- 日志测试
  - 客户端日志
  - 服务端日志
- 弱网测试
  - 不同网络情况，游戏运行情况，如edge、2g、3g、4g情况
  - 不同丢包率情况下游戏运行情况
  - 通过工具设置网络代理实现，常用**fiffler、network link conditioner**
- gm工具测试
  - 测试gm工具的功能实现，需要关注工具的设置是否在游戏中起作用
  - 测试gm工具的数据读取、存储
- SDK测试
  - 用户数据测试
  - 充值、消费测试
  - 与各个渠道对接测试

### 1-3 游戏测试基本工作流程

> 功能需求会议
>
> 测试用例书写
>
> 冒烟测试
>
> 详细测试
>
> 回归测试
>
> Checklist检查

- 功能会议
  - 了解功能需求内容
  - 提出可能存在的风险点
  - 思考功能的测试重点和难点，如果需要工具辅助，提出开发需求
  - 思考可以优化的地方，提出讨论
- 测试用例书写
  - 根据需求书写测试用例
  - 关注功能逻辑实现
  - 考虑各种特殊情况，边界值、网络中断、进程中断等
  - 关注需求变更情况，需求经常发生变更，需要及时调整测试用例
- 冒烟测试
  - 详细测试之前的一个环节
  - **快速发现比较明显的bug**
  - 快速确保主逻辑流程跑通
  - 快速明确功能开展状态
- 详细测试
  - 细致的测试每一个逻辑分支、资源、配置
  - 尽量模拟玩家的每一种操作可能
  - 测试异常情况、断网、断电、事件中断、进程中断等情况
  - 测试数据读取、存储、网络等内容
  - 测试该功能对其他功能的影响
- 回归测试
  - 测试已经被修复的内容
  - 测试需求调整后的内容
  - 再次详细测试各逻辑分支
- checklist检查
  - 简要快速检查功能的主要逻辑点
  - 简要检查与该功能有关联的任何其他功能点



## 2. 游戏测试用例

> 需求文档分析
>
> 功能模块划分
>
> 测试用例编写
>
> 测试用例整理与维护

### 2-1 需求文档分析

- 文档阅读

  >  切忌不阅读文档，上来直接写用例，至少读3遍文档

  - 细致理解功能设计意图和设计思路
  - 避免粗略理解带来的用例遗漏
  - 一些重要的数据可能隐藏在不起眼的语句中
  - 加深对功能的理解，否侧随着时间推移会忘

  >  带着思考去阅读，如果自己去设计会怎么优化？

- 功能细节沟通探讨

  - 不明白的地方要及时确认，切忌脑补想当然；
  - 尽早确认细节，最好在开始写之前就确认完毕；
  - 关注需求变更，需求变更后，一定要和程序和策划确认；

- 逻辑梳理

  - 文档不一定是按照流程顺序写的，经常存在功能交叉的地方
  - 梳理出框架后，逐步细化

- 功能拓展思考

  - 设计缺陷思考
  - 测试难点思考
  - 关联度思考
  - 特殊情况思考

- 兼容相关思考

  - 版本兼容
  - 功能兼容
  - 操作系统版本兼容
  - 分辨率兼容

### 2-2 功能模块划分

> 功能模块划分遵循什么样的规则
>
> 功能模块划分有什么比较好的方法

- 模块划分原则

  - 高内聚，低耦合
    - 模块内部紧密结合，模块间关联度要低不能合并为一个模块
  - 重整体，轻局部
    - 有大局观，不要纠结于具体细节

- 模块划分方法

  - 功能流程法：将功能的基本流程画出来，根据流程的每个大环节进行模块划分，再细化、查漏补缺。

  - 层次划分法：按照逻辑层次逐层细化出模块的过程，比较适用于UI划分，大的系统模块划分等。

  - 类型划分法：按照功能包含内容不同类型进行划分。

    > - 不同划分方法适用于不同场景，具体问题具体分析
    > - 有时候一个功能需要结合多种方法划分
    > - 划分方法不重要，划分原则更重要
    > - 划分完毕后，要结合需求文档重新梳理，确保模块清晰、覆盖完整

### 2-3 测试用例编写

- 格式

  - 一个清晰的格式很重要

    - 让用例的脉络更清晰
    - 方便需求变化后的更新维护
    - 方便执行人员快速入手

  - 首页内容

    - 用例名称

    - 用例对应的游戏版本

    - 编写人、编写日期、备注

    - 修改人、修改日期、修改备注

    - 需求文档的链接、地址

      > 正文页内容：
      >
      > - 功能逻辑图（如果有）
      > - 用例ID
      > - 模块名称
      > - 测试先觉条件
      > - 输入信息
      > - 输出结果
      > - 备注信息

    > 格式注意点：
    >
    > - 尽量保证逻辑清晰
    >
    > - 尽量保证一个输入只对应一个输出
    > - 保证每次更新用例后都有明确的记录标注
    > - 尽量保证一个用例内格式统一

- 常用测试用例编写方法

  - 等价类

    > 一个输入集合内，任何输入数据对于输出的验证来讲都是等效的，此时就可以选取少量代表性的测试数据来代表整体数据。

    - 有效等价类：是对输出来讲有意义的输入集合，可以验证程序的正常功能和流程。
    - 无效等价类：是对输出无意义的输入组合，用于验证非正常流程输入对输出的影响。

    > 测试购买道具时金币不足这个功能点；
    >
    > 道具10，设置身上金币10，11，9三种情况下购买道具，即可代表所有数据测试。

  - 边界值

    - 对输入、输出的边界值进行分析的一种方法；
    - 边界值的确定：一般选取正好等于，刚刚小于/大于三种情况作为测试数据；
    - 通常适用范围：数值测试，字符串测试，数据类型测试等；

  - 因果图&判定表

    - 输入与输出之间因果关系的一种关系图；
    - 判定表：可以通过因果图来生成的一种结果判定表格；
    - 因果图常与判定表一起使用，通过因果图生成判定表，通过判定表来书写测试用例；

- 测试用例编写注意事项

  - 输入条件单一明确，不用易引起误解的词：可能、大概等；
  - 输出要可判断且明确。最好不要用“显示正确”这种词；
  - 测试步骤要可执行；
  - 保持尽量高的覆盖率；
  - 能抽象的尽量抽象出来，避免无意义的冗余；

### 2-4 测试用例整理于维护

- 需求变化后需要及时更新老的测试用例，并写清修改情况的备注（修改内容，产品和开发负责人）；
- 测试用例应该尽量避免冗余，遇到重复用例，需要根据实际情况进行修改；
- 注意测试用例备份，避免线上被人误删除；



## 3. 游戏Bug详解

### 3-1 游戏Bug详解

> 发现bug只是测试工作的开始

- bug的界定标准

  - 与需求设计不符
  - 违背常识

- bug的生命周期

- bug等级划分

  - P0:致命错误；需要立即修复，宕机、重启性报错；
  - P1:严重错误；需要紧急修复，功能流程错误，数值错误；
  - P2：一般错误；允许一段时间内修复，功能简单错误，界面错误；
  - P3:无关紧要的错误，允许延期修复，文字错误，某像素点缺失；

- bug的提报标准：

  - 标题：【模块名称】+简短描述
  - 测试环境：测试用的版本，系统，服务器，账号等
  - 描述：bug的详细描述
  - 重现步骤：重现bug的详细流程步骤及重现概率
  - 期望结果：希望bug修复后的结果
  - 备注：log，截图等

- bug的验证标准

  - 严格按照复现步骤验证；
  - 去除测试环境的影响；
  - 验证标注：需要注明验证的版本、服务器等；

  - 拓展：是否对其他功能有影响，做简单回归；
  - 注意点：验证不能只看前端展现，更应该关注后端数据；

- bug的跟踪与推动
  - 每个人都有责任跟踪自己的bug的修复状态
  - 及时与开发沟通，了解修复状态并提供修复过程中的支持
  - 久不修复的bug需要与开发和上级确认如何处理
  - bug修复后，需要及时验证
- bug的数据分析
  - 按重要性分析bug分布
  - 人员分析bug分布
  - 功能模块bug分布

## 4. 游戏弱网测试 — mac环境

- 弱网测试 — 案例
  - 地铁
  - 火车
  - 边远地区
  - 高层建筑
  - 汽车
- 弱网测试要解决的问题
  - 网络信号差，对游戏运行的影响；
  - 高丢包率的网络环境，对游戏运行的影响；
  - 不同网络信号之间切换时，对游戏运行的影响；
  - 断线重连对游戏运行的影响；
  - 前后端数据一致的问题；
- 测试方法
  - mac系统：**Network Link Conditioner 或者 Charles**；
  - Windows：**Fiddler**；

## 5. 游戏性能测试

> - 客户端性能指标 — CPU
>
>   - 指游戏进程所占的CPU占用率；
>   - 抛开场景谈CPU性能无意义；
>   - 安卓设备，90%的场景中CPU占用率小于60%；
>   - ios设备，90%的场景CPU占用率小于80%；
>
> - 客户端性能指标 — 内存（16年标准）
>
>   - 高端设备
>
>     > iPhone6及以上；4核2.3GHZ以上，3G以上；
>     >
>     > ios占用小于360M；安卓占用小于450M；
>
>   - 中端设备
>
>     > iPhone5s左右；4核2.3GHZ左右；2G；
>     >
>     > ios占用小于300M；安卓占用小于350M；
>
>   - 低端机型
>
>     > iPhone4s左右；4核1.5GHZ左右，1G；
>     >
>     > ios占用小于200M；安卓占用小于256M；
>
> - 客户端性能指标 — FPS（16年标准）
>
>   - 高端机型：90%游戏场景不低于25；
>   - 中端机型：90%游戏场景不低于25；
>   - 低端机型：90%游戏场景不低于18；

### 5-1 游戏客户端性能测试 — 安卓

- 常用工具：
  - Emmagee
  - GT

### 5-2 游戏客户端性能测试 — ios

- xCode —> Open Development Tool —> Instruments —> Activity Tools —> 将设备和电脑用usb连接
- FPS: // Instruments —> Core Animation

## 6. 游戏接口测试

- 什么是接口：
  - 暴露出来的属性/方法，可以被本程序/别的程序调用；
- 常见接口分类：
  - 程序内部模块接口；
  - 程序暴露给外部其他程序调用的接口；

### 接口测试的主要内容

- 客户端与服务端之间的网络接口测试
  - 看数据传输是否正确
  - 抓作弊
- 测试常用工具
  - Jmeter或自己写脚本语言

